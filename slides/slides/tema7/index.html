<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Tema 7 - Indexación espacial</title>

		<meta name="description" content="Curso de Bases de Datos Espaciales con PostGIS 2.0">
		<meta name="author" content="geomati.co">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="../css/reveal.min.css">
		<link rel="stylesheet" href="../css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="../lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="../css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="../lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element between this containers is displayed as a slide -->
			
<div class="slides">
    <section>
        <h1>
            <br>
        </h1>
<h1>
        <br>
        </h1>
<h1>
<span>Indexación espacial</span>
        <br>
</h1>
    </section>
    <section>
        <h2>Objetivos</h2>
<div>
        <br>
    </div>
<div>
    <br>
</div>
<div>
<br>
</div>
<div>
<div>Conocer los fundamentos de la indexación espacial</div>
<div>Aprender a crear índices GiST</div>
</div>
</section>
<section>
    <h2>indexación espacial</h2>
<div>
    <br>
</div>
<div>
<br>
</div>
<div>
<br>
</div>
<div>La indexación espacial es una de las funcionalidades más importantes de las bases de datos espaciales<br>
</div>
<div>
<br>
</div>
<div>¡Se deben usar cuando las tablas exceden de algunos miles de filas!<br>
</div>
</section>
<section>
    <h2 class="absolute-element" style="position: absolute; width: 457px; height: 67px; z-index: 4; left: 243px; top: 20px;">Índices espaciales</h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div class="absolute-element" style="position: absolute; width: 952px; height: 93px; z-index: 4; left: -1px; top: 471px;">La caja (box) es el rectángulo definido por las máximas y mínimas coordenadas x e y de una geometría.<br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div class="absolute-element" style="position: absolute; width: 447px; height: 328px; z-index: 4; left: 266px; top: 118px;">
        <img src="img/bbox.png">
        <br>
    </div>
</section>
<section>
    <h2>Índices espaciales</h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <font style="font-size: 24px;">En la figura se puede observar que solo la linea intersecta a la estrella amarilla, mientras que si utilizamos los índices comprobaremos que la caja amarilla es intersectada por dos figuras la caja roja y la azul. El camino eficiente para responder correctamente a la pregunta ¿qué elemento intersecta la estrella amarilla? es primero responder a la pregunta ¿qué cajas intersectan la caja amarilla? usando el índice (consulta rápida) y luego calcular exactamente ¿quien intersecta a la estrella amarilla? sobre el resultado de la consulta de las cajas.</font>
        <br>
    </div>
    <div class="absolute-element" style="position: absolute; width: 567px; height: 175px; z-index: 4; left: 192px; top: 132px;">
        <img src="img/index-sample.png">
        <br>
    </div>
    <div class="absolute-element" style="position: absolute; width: 567px; height: 175px; z-index: 4; left: 192px; top: 132px;">
        <br>
    </div>
</section>
<section>
    <h2>crear un índice espacial</h2>
    <div>
        <br>
    </div>
    <div>
        <div>La síntaxis será la siguiente::</div>
        <div>
            <br>
        </div>
        <div>
            <span class="Apple-tab-span" style="white-space:pre">	</span>
            <i>CREATE INDEX [Nombre_del_indice] ON [Nombre_de_tabla] USING GIST ([campo_de_geometria]);</i>
        </div>
        <div>
            <span class="Apple-tab-span" style="white-space:pre">	</span>
        </div>
        <div>Esta operación puede requerir bastante tiempo en tablas de gran tamaño.&nbsp;</div>
    </div>
    <div>
        <br>
    </div>
</section>
<section>
    <h2>planificador</h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>El planificador de PostgreSQL debe averiguar que el uso de los índices beneficia a las búsquedas. Se debe obligar al sistema a que actualice sus estadísticas.<br>
    </div>
</section>
<section>
    <h2>vacuum analyze</h2>
    <div>
        <br>
    </div>
    <div>
        <div>
            <i>VACUUM ANALYZE [nombre de la tabla]</i>
        </div>
        <div>
            <i>VACUUM ANALYZE [nombre de la tabla] (nombre de la columna)</i>
        </div>
    </div>
    <div>
        <i>
        <br>
    </i>
</div>
<div>
    <i>
    <br>
</i>
</div>
<div>
    <i>
    <br>
</i>
</div>
<div>Esta orden actualiza las estadísticas del planificador y elimina los datos borrados(al eliminar con DELETE no se borran los datos de la tabla si no que se marcan como eliminados)<br>
</div>
</section>
<section>
    <h2>vacuum</h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <div>
            <i>VACUUM [nombre de la tabla]</i>
        </div>
        <div>
            <i>VACUUM [nombre de la tabla] (nombre de la columna)</i>
        </div>
    </div>
    <div>
        <i>
        <br>
    </i>
</div>
<div>
    <i>
    <br>
</i>
</div>
<div>Esta orden simplemente elimina los datos borrados pero no actualiza las estadísticas<br>
</div>
</section>
<section>
    <h2>autovacuum</h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>Autovacuum ejecuta las operaciones de VACUUM de manera automática<br>
    </div>
</section>
<section>
    <h2>
        <br>
    </h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>Una vez creado el índice, hemos de obligar al planificador a actualizar las estadísticas<br>
    </div>
</section>
<section>
    <h2>uso del índice</h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <div>Para usar el índice debemos incluir el operador <b>&amp;&amp;</b> en nuestras consultas</div>
        <div>Para las geometrías, el operador <b>&amp;&amp;</b> significa “la caja que toca (touch) o superpone (overlap)” de la misma manera que para un número el operador = significa “valores iguales”</div>
    </div>
</section>
<section>
    <h2>explain</h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>PostgreSQL ofrece el comado EXPLAIN para mostrar el plan de ejecución, los pasos que sigue a la hora de ejecutar la consulta SQL<br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <i>EXPLAIN [ANALYZE] [VERBOSE] sentenciaSQL</i>
        <br>
    </div>
</section>
<section>
    <h2>operador de cajas</h2>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <br>
    </div>
    <div>
        <div>Muchas de las operaciones habituales de PostGIS dispone de operador de cajas, por ejemplo:</div>
        <div>
            <br>
        </div>
        <div>
            <i>ST_Intersects VS _ST_Intersects</i>
        </div>
    </div>
</section>
</div>

			<!-- Any section element between this container is displayed as a slide -->
		</div>

		<script src="../lib/js/head.min.js"></script>
		<script src="../js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: '../plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>			
